-- RoohrHub LocalScript
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local ContentProvider = game:GetService("ContentProvider")
local Lighting = game:GetService("Lighting")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- CLEAN UP OLD HUB & BLURS
local oldHub = playerGui:FindFirstChild("RoohrHub")
if oldHub then oldHub:Destroy() end
for _, v in ipairs(Lighting:GetChildren()) do
	if v:IsA("BlurEffect") then v:Destroy() end
end

-- ROOT GUI
local hubGui = Instance.new("ScreenGui")
hubGui.Name = "RoohrHub"
hubGui.ResetOnSpawn = false
hubGui.Parent = playerGui

-- COLORS
local baseColor = Color3.fromRGB(28,28,28)
local accentColor = Color3.fromHex("#85144B")

-- BLUR
local blur = Instance.new("BlurEffect")
blur.Size = 0
blur.Parent = Lighting

-- TWEEN HELPER
local function tween(obj, props, time, style, dir, cb)
	local info = TweenInfo.new(time or 0.45, style or Enum.EasingStyle.Quart, dir or Enum.EasingDirection.Out)
	local t = TweenService:Create(obj, info, props)
	t:Play()
	if cb then t.Completed:Once(cb) end
	return t
end

-- CLICK SOUND
local function playClickSound(parent)
	local s = Instance.new("Sound")
	s.SoundId = "rbxassetid://87437544236708"
	s.Volume = 1
	s.Parent = parent
	s:Play()
end

-- ================= KEY SYSTEM =================
local keyFrame = Instance.new("Frame")
keyFrame.Size = UDim2.new(0,520,0,280)
keyFrame.Position = UDim2.new(0.5,0,1.5,0) -- start offscreen
keyFrame.AnchorPoint = Vector2.new(0.5,0.5)
keyFrame.BackgroundColor3 = baseColor
keyFrame.Parent = hubGui
Instance.new("UICorner", keyFrame).CornerRadius = UDim.new(0,25)
local keyOutline = Instance.new("UIStroke", keyFrame)
keyOutline.Color = accentColor
keyOutline.Thickness = 3

-- Title
local keyTitle = Instance.new("TextLabel")
keyTitle.Size = UDim2.new(1,0,0,60)
keyTitle.Position = UDim2.new(0,0,0,10)
keyTitle.BackgroundTransparency = 1
keyTitle.Font = Enum.Font.GothamBold
keyTitle.TextSize = 32
keyTitle.TextColor3 = Color3.fromRGB(255,255,255)
keyTitle.Text = "Enter Your Key"
keyTitle.TextScaled = true
keyTitle.TextXAlignment = Enum.TextXAlignment.Center
keyTitle.TextYAlignment = Enum.TextYAlignment.Center
keyTitle.Parent = keyFrame

-- Info text
local infoLabel = Instance.new("TextLabel")
infoLabel.Size = UDim2.new(0.9,0,0,30)
infoLabel.Position = UDim2.new(0.05,0,0.25,0)
infoLabel.BackgroundTransparency = 1
infoLabel.Font = Enum.Font.Gotham
infoLabel.TextSize = 18
infoLabel.TextColor3 = Color3.fromRGB(200,200,200)
infoLabel.Text = "Use a free or premium key to access RoohrHub."
infoLabel.TextXAlignment = Enum.TextXAlignment.Center
infoLabel.TextYAlignment = Enum.TextYAlignment.Center
infoLabel.Parent = keyFrame

-- Textbox for key
local keyBox = Instance.new("TextBox")
keyBox.Size = UDim2.new(0.8,0,0,50)
keyBox.Position = UDim2.new(0.1,0,0.4,0)
keyBox.Text = ""
keyBox.PlaceholderText = "Enter your key..."
keyBox.Font = Enum.Font.Gotham
keyBox.TextSize = 24
keyBox.TextColor3 = Color3.new(1,1,1)
keyBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
keyBox.Parent = keyFrame
Instance.new("UICorner", keyBox).CornerRadius = UDim.new(0,12)

-- Submit button
local submitButton = Instance.new("TextButton")
submitButton.Size = UDim2.new(0.45,0,0,50)
submitButton.Position = UDim2.new(0.25,0,0.75,0)
submitButton.Text = "Submit"
submitButton.Font = Enum.Font.GothamBold
submitButton.TextSize = 24
submitButton.TextColor3 = Color3.new(1,1,1)
submitButton.BackgroundColor3 = Color3.fromRGB(50,50,50)
submitButton.Parent = keyFrame
Instance.new("UICorner", submitButton).CornerRadius = UDim.new(0,18)

-- Hover effect for Submit
submitButton.MouseEnter:Connect(function()
	tween(submitButton, {BackgroundColor3 = Color3.fromRGB(70,70,70)}, 0.15)
end)
submitButton.MouseLeave:Connect(function()
	tween(submitButton, {BackgroundColor3 = Color3.fromRGB(50,50,50)}, 0.15)
end)

-- Allowed keys with optional HWID binding
local keys = {
    ["FREE-KEY"] = {Type = "free", HWID = nil},
    ["FREE-KEY2"] = {Type = "free", HWID = nil},
    ["PREMIUM-KEY"] = {Type = "premium", HWID = "6A440A67-DEBF-4662-9129-E3E1D5EFCF6B"},
    ["PREMIUM-KEY2"] = {Type = "premium", HWID = "354sfd"},
}

local userKeyType = nil -- will store "free" or "premium"

-- Tween key frame in with sound
local keySound = Instance.new("Sound")
keySound.SoundId = "rbxassetid://3779053277" -- replace with preferred sound
keySound.Volume = 1
keySound.Parent = keyFrame
keySound:Play()

tween(keyFrame, {Position = UDim2.new(0.5,0,0.5,0)}, 0.6)

-- ================= COPY DISCORD BUTTON =================
local discordButton = Instance.new("TextButton")
discordButton.Size = UDim2.new(0,50,0,50) -- square button for logo
discordButton.Position = UDim2.new(0.9,0,.85,0) -- adjust as needed
discordButton.AnchorPoint = Vector2.new(0.5,0.5)
discordButton.Text = ""
discordButton.BackgroundColor3 = Color3.fromRGB(50,50,50)
discordButton.Parent = keyFrame
Instance.new("UICorner", discordButton).CornerRadius = UDim.new(0,12)

-- Discord logo
local discordLogo = Instance.new("ImageLabel")
discordLogo.Size = UDim2.new(0.7,0,0.7,0)
discordLogo.Position = UDim2.new(0.15,0,0.15,0) -- center inside button
discordLogo.BackgroundTransparency = 1
discordLogo.Image = "rbxassetid://8387379647"
discordLogo.Parent = discordButton

-- Hover effect for Discord button
discordButton.MouseEnter:Connect(function()
	tween(discordButton, {BackgroundColor3 = Color3.fromRGB(70,70,70)}, 0.15)
end)
discordButton.MouseLeave:Connect(function()
	tween(discordButton, {BackgroundColor3 = Color3.fromRGB(50,50,50)}, 0.15)
end)

-- Copy Discord functionality
discordButton.MouseButton1Click:Connect(function()
	if setclipboard then
		setclipboard("https://discord.gg/EtyVdWYR")
		-- optional: play a success sound here
	else
		warn("setclipboard not supported")
	end
end)

-- ================= TERMS OF USE =================
local termsFrame = Instance.new("Frame")
termsFrame.Size = UDim2.new(0,700,0,500) -- taller to prevent overlap
termsFrame.Position = UDim2.new(0.5,0,1.5,0) -- start off-screen
termsFrame.AnchorPoint = Vector2.new(0.5,0.5)
termsFrame.BackgroundColor3 = baseColor
termsFrame.BorderSizePixel = 0
termsFrame.Parent = hubGui

Instance.new("UICorner", termsFrame).CornerRadius = UDim.new(0,25)
local outline = Instance.new("UIStroke", termsFrame)
outline.Color = accentColor
outline.Thickness = 3

-- Title
local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1,0,0,60)
titleLabel.Position = UDim2.new(0,0,0,10)
titleLabel.BackgroundTransparency = 1
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 36
titleLabel.TextColor3 = Color3.fromRGB(255,255,255)
titleLabel.Text = "RoohrHub Terms of Use"
titleLabel.TextScaled = true
titleLabel.TextXAlignment = Enum.TextXAlignment.Center
titleLabel.TextYAlignment = Enum.TextYAlignment.Center
titleLabel.Parent = termsFrame

-- Scrollable content
local scroll = Instance.new("ScrollingFrame")
scroll.Size = UDim2.new(0.95,0,0.7,0)
scroll.Position = UDim2.new(0.025,0,0.15,0)
scroll.BackgroundTransparency = 1
scroll.CanvasSize = UDim2.new(0,0,0,250) -- allow space for bullets
scroll.ScrollBarThickness = 8
scroll.Parent = termsFrame

-- UIListLayout for bullets
local layout = Instance.new("UIListLayout")
layout.Parent = scroll
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.Padding = UDim.new(0,12)

-- Terms content (bullets)
local terms = {
	"Do not share this hub.",
	"Use it responsibly.",
	"Respect others.",
	"Scripts may change at any time.",
	"You agree by checking the box and clicking 'Agree'."
}

for i, text in ipairs(terms) do
	local bullet = Instance.new("TextLabel")
	bullet.Size = UDim2.new(1,0,0,45)
	bullet.BackgroundTransparency = 1
	bullet.Font = Enum.Font.GothamSemibold
	bullet.TextSize = 24
	bullet.TextColor3 = Color3.fromRGB(240,240,240)
	bullet.TextXAlignment = Enum.TextXAlignment.Left
	bullet.TextYAlignment = Enum.TextYAlignment.Top
	bullet.RichText = true
	bullet.Text = "• "..text
	bullet.Parent = scroll
end

-- ================= CHECKBOX =================
local isChecked = false

local checkboxContainer = Instance.new("Frame")
checkboxContainer.Size = UDim2.new(0,30,0,30)
checkboxContainer.Position = UDim2.new(0.05,0,0.88,0) -- bottom-left
checkboxContainer.BackgroundColor3 = Color3.fromRGB(40,40,40)
checkboxContainer.BorderSizePixel = 0
checkboxContainer.Parent = termsFrame
Instance.new("UICorner", checkboxContainer).CornerRadius = UDim.new(0,5)
local checkboxOutline = Instance.new("UIStroke", checkboxContainer)
checkboxOutline.Color = accentColor
checkboxOutline.Thickness = 2

local checkMark = Instance.new("Frame")
checkMark.Size = UDim2.new(0.6,0,0.6,0)
checkMark.Position = UDim2.new(0.2,0,0.2,0)
checkMark.BackgroundColor3 = accentColor
checkMark.Visible = false
checkMark.Parent = checkboxContainer
Instance.new("UICorner", checkMark).CornerRadius = UDim.new(0,3)

local checkboxLabel = Instance.new("TextLabel")
checkboxLabel.Size = UDim2.new(0.6,0,0,30)
checkboxLabel.Position = UDim2.new(0.12,40,0.88,0)
checkboxLabel.BackgroundTransparency = 1
checkboxLabel.Text = "I agree to the Terms of Use"
checkboxLabel.Font = Enum.Font.Gotham
checkboxLabel.TextSize = 22
checkboxLabel.TextColor3 = Color3.new(1,1,1)
checkboxLabel.TextXAlignment = Enum.TextXAlignment.Left
checkboxLabel.Parent = termsFrame

checkboxContainer.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		isChecked = not isChecked
		checkMark.Visible = isChecked
		playClickSound(checkboxContainer)
	end
end)

-- ================= AGREE BUTTON =================
local agreeButton = Instance.new("TextButton")
agreeButton.Size = UDim2.new(0,180,0,55)
agreeButton.Position = UDim2.new(0.84,0,0.9,0) -- adjust for center anchor
agreeButton.AnchorPoint = Vector2.new(0.5,0.5) -- center
agreeButton.BackgroundColor3 = Color3.fromRGB(40,40,40)
agreeButton.Text = "Agree"
agreeButton.Font = Enum.Font.GothamBold
agreeButton.TextSize = 24
agreeButton.TextColor3 = Color3.fromRGB(255,255,255)
agreeButton.Parent = termsFrame

Instance.new("UICorner", agreeButton).CornerRadius = UDim.new(0,18)

local buttonStroke = Instance.new("UIStroke", agreeButton)
buttonStroke.Color = accentColor
buttonStroke.Thickness = 2

-- Hover effect (grow from center)
agreeButton.MouseEnter:Connect(function()
	tween(agreeButton, {Size = UDim2.new(0,195,0,60)}, 0.2)
end)
agreeButton.MouseLeave:Connect(function()
	tween(agreeButton, {Size = UDim2.new(0,180,0,55)}, 0.2)
end)

-- ================= GAME-SPECIFIC SCRIPTS =================
local gameScripts = {
    [168556275] = {
        free = function()
            print("Baseplate Free Script")
        end,
        premium = function()
            print("Baseplate Premium Script")
        end
    },
    [18112334178] = {
        free = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/WolfHayden/NBD/refs/heads/main/Free"))()
        end,
        premium = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/QaPd/Eri-No-Big-Deal-Script-FIXED-/refs/heads/main/Premium"))()
        end
    }
}

local supportedGames = {
	[168556275] = true,
	[87654321] = true
}

local function runGameScript()
    local gameTable = gameScripts[game.PlaceId]
    if gameTable and userKeyType then
        gameTable[userKeyType]()
    end
end

-- INTRO
local function openIntro()
	tween(blur, {Size = 25}, 0.5)

	local introFrame = Instance.new("Frame")
	introFrame.Size = UDim2.new(0,800,0,400)
	introFrame.Position = UDim2.new(0.5,0,1.5,0) -- start off-screen
	introFrame.AnchorPoint = Vector2.new(0.5,0.5)
	introFrame.BackgroundColor3 = baseColor
	introFrame.Parent = hubGui

	Instance.new("UICorner", introFrame).CornerRadius = UDim.new(0,30)
	local outlineIntro = Instance.new("UIStroke", introFrame)
	outlineIntro.Color = accentColor
	outlineIntro.Thickness = 3

	-- Tween intro frame in
	tween(introFrame, {Position = UDim2.new(0.5,0,0.5,0)}, 0.6)

	-- INTRO SOUND
	local introSound = Instance.new("Sound")
	introSound.SoundId = "rbxassetid://1538835907"
	introSound.Volume = 1
	introSound.Parent = introFrame
	introSound:Play()

	-- LOGO
	local logoImg = Instance.new("ImageLabel")
	logoImg.Size = UDim2.new(0,200,0,200)
	logoImg.Position = UDim2.new(0.5,0,0.5,0)
	logoImg.AnchorPoint = Vector2.new(0.5,0.5)
	logoImg.BackgroundTransparency = 1
	logoImg.ImageTransparency = 1
	logoImg.Image = "rbxassetid://97046632760597"
	logoImg.Parent = introFrame

	ContentProvider:PreloadAsync({logoImg.Image})

	-- Fade in logo immediately
	tween(logoImg, {ImageTransparency = 0}, 0.4)
	tween(logoImg, {Size = UDim2.new(0,300,0,300)}, 0.8)

	-- Delay 2 seconds before moving logo left and showing text
	task.delay(1.6, function()
		-- Move logo left
		tween(logoImg, {Position = UDim2.new(0.5,-100,0.5,0)}, 0.8)

		-- Text appears flowing out of logo
		local logoText = Instance.new("TextLabel")
		logoText.Text = "RoohrHub"
		logoText.Font = Enum.Font.GothamBold
		logoText.TextSize = 1
		logoText.TextTransparency = 1
		logoText.TextColor3 = Color3.new(1,1,1)
		logoText.BackgroundTransparency = 1
		logoText.Position = UDim2.new(0.5,140,0.5,0)
		logoText.AnchorPoint = Vector2.new(0,0.5)
		logoText.Parent = introFrame

		tween(logoText, {TextTransparency = 0, TextSize = 48, Position = UDim2.new(0.5,180,0.5,0)}, 0.8)
	end)

	-- Exit intro after 5 seconds (matches longer intro)
	task.delay(5, function()
		tween(introFrame, {Position = UDim2.new(0.5,0,1.5,0)}, 0.6)
		tween(blur, {Size = 0}, 0.6, nil, nil, function()
			blur:Destroy() -- ✅ FINAL BLUR CLEANUP
		end)
		task.delay(0.65, function()
			introFrame:Destroy()
			runGameScript()
		end)
	end)
end

-- ================= GAME MENU =================
local function openGameMenu()
	tween(blur,{Size = 20},0.4)

	local menuFrame = Instance.new("Frame")
	menuFrame.Size = UDim2.new(0,600,0,250)
	menuFrame.Position = UDim2.new(0.5,0,1.5,0)
	menuFrame.AnchorPoint = Vector2.new(0.5,0.5)
	menuFrame.BackgroundColor3 = baseColor
	menuFrame.Parent = hubGui

	Instance.new("UICorner", menuFrame).CornerRadius = UDim.new(0,20)
	local outlineMenu = Instance.new("UIStroke", menuFrame)
	outlineMenu.Color = accentColor
	outlineMenu.Thickness = 3

	tween(menuFrame,{Position = UDim2.new(0.5,0,0.5,0)},0.6)

	local isSupported = supportedGames[game.PlaceId]

	local statusLabel = Instance.new("TextLabel")
	statusLabel.Size = UDim2.new(1,0,0,60)
	statusLabel.Position = UDim2.new(0,0,0,80)
	statusLabel.BackgroundTransparency = 1
	statusLabel.Font = Enum.Font.GothamBold
	statusLabel.TextSize = 26
	statusLabel.TextColor3 = isSupported and Color3.fromRGB(0,255,0) or Color3.fromRGB(255,0,0)
	statusLabel.Text = isSupported and "Supported" or "Not Supported"
	statusLabel.Parent = menuFrame

	local proceedButton = Instance.new("TextButton")
	proceedButton.Size = UDim2.new(0,150,0,50)
	proceedButton.Position = UDim2.new(0.5,-75,0.75,0)
	proceedButton.BackgroundColor3 = Color3.fromRGB(60,60,60)
	proceedButton.Text = "Proceed"
	proceedButton.Font = Enum.Font.Gotham
	proceedButton.TextSize = 22
	proceedButton.TextColor3 = Color3.new(1,1,1)
	proceedButton.Parent = menuFrame
	Instance.new("UICorner", proceedButton).CornerRadius = UDim.new(0,15)

	proceedButton.MouseButton1Click:Connect(function()
		playClickSound(proceedButton)
		tween(menuFrame,{Position = UDim2.new(0.5,0,1.5,0)},0.45)
		task.delay(0.55,function()
			menuFrame:Destroy()
			if isSupported then
				openIntro()
			else
				tween(blur,{Size=0},0.4,function() blur:Destroy() end)
			end
		end)
	end)
end

-- ================= AGREEMENT BUTTON WITH CHECKBOX =================
agreeButton.MouseButton1Click:Connect(function()
	if isChecked then
		-- User checked the box: proceed
		playClickSound(agreeButton)
		tween(termsFrame, {Position = UDim2.new(0.5,0,1.5,0)}, 0.5)
		task.delay(0.6, function()
			termsFrame:Destroy()
			openGameMenu()
		end)
	else
		-- User did NOT check the box: shake GUI and play warning sound
		local originalPos = termsFrame.Position
		for i = 1,6 do
			tween(termsFrame, {Position = originalPos + UDim2.new(0, (i % 2 == 0 and 10 or -10), 0, 0)}, 0.03)
			task.wait(0.03)
		end
		tween(termsFrame, {Position = originalPos}, 0.05)

		-- Warning sound
		local warnSound = Instance.new("Sound")
		warnSound.SoundId = "rbxassetid://107294127858629"
		warnSound.Volume = 1
		warnSound.Parent = termsFrame
		warnSound:Play()
	end
end)

submitButton.MouseButton1Click:Connect(function()
    local enteredKey = keyBox.Text:upper()
    local keyData = keys[enteredKey]

    local function shakeFrame(frame)
        local originalPos = frame.Position
        for i = 1,6 do
            tween(frame, {Position = originalPos + UDim2.new(0, (i % 2 == 0 and 10 or -10), 0, 0)}, 0.03)
            task.wait(0.03)
        end
        tween(frame, {Position = originalPos}, 0.05)
    end

    if keyData then
        if keyData.Type == "premium" then
            local hwid = game:GetService("RbxAnalyticsService"):GetClientId()
            
            if keyData.HWID == nil then
                -- Bind the HWID to this premium key
                keyData.HWID = hwid
                userKeyType = "premium"
            elseif keyData.HWID == hwid then
                -- HWID matches, allow access
                userKeyType = "premium"
            else
                -- HWID mismatch, deny access
                local errorSound = Instance.new("Sound")
                errorSound.SoundId = "rbxassetid://107294127858629"
                errorSound.Volume = 1
                errorSound.Parent = submitButton
                errorSound:Play()
                
                shakeFrame(keyFrame) -- Shake UI on HWID mismatch
                warn("This premium key is already bound to another device.")
                return
            end
        else
            -- Free key
            userKeyType = "free"
        end

        -- Success sound
        local successSound = Instance.new("Sound")
        successSound.SoundId = "rbxassetid://97881181065416"
        successSound.Volume = 1
        successSound.Parent = submitButton
        successSound:Play()

        -- Close key GUI and open Terms of Use
        tween(keyFrame, {Position = UDim2.new(0.5,0,1.5,0)}, 0.5)
        task.delay(0.55, function()
            keyFrame:Destroy()
            wait(1)
            tween(termsFrame,{Position=UDim2.new(0.5,0,0.5,0)},0.6)
        end)
    else
        -- Invalid key: shake with error sound
        local errorSound = Instance.new("Sound")
        errorSound.SoundId = "rbxassetid://107294127858629"
        errorSound.Volume = 1
        errorSound.Parent = submitButton
        errorSound:Play()

        shakeFrame(keyFrame)
    end
end)
